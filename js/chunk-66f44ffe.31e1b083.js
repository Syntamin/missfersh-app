(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66f44ffe"],{"056a":function(t,s,o){"use strict";o("3589")},1845:function(t,s,o){"use strict";o("9b4d")},"2d3b":function(t,s,o){"use strict";o.r(s);var i=function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"search-wrapper"},[o("div",{staticClass:"search-header"},[o("van-icon",{staticClass:"arrow-left",attrs:{name:"arrow-left"},on:{click:function(s){return t.$router.goback()}}}),o("van-search",{staticClass:"search-input",attrs:{"show-action":"",placeholder:t.placeholder},on:{input:t.onInput,focus:t.onFocus},scopedSlots:t._u([{key:"action",fn:function(){return[t.isIcon?o("div",{staticClass:"search-icon",on:{click:t.onSearch}},[t._v("搜索")]):o("van-icon",{attrs:{name:"shopping-cart-o",id:"shopping-car",badge:t.badge},on:{click:function(s){return t.$router.push({name:"Shopping"})}}})]},proxy:!0}]),model:{value:t.searchValue,callback:function(s){t.searchValue=s},expression:"searchValue"}})],1),o("div",{staticClass:"search-result"},[t.showResult?o("van-list",{staticClass:"showResult",attrs:{"finished-text":"没有更多了","immediate-check":!1}},t._l(t.searchResult,(function(s){return o("van-cell",{key:s,staticClass:"result-item",attrs:{title:s},on:{click:function(o){return t.onClickGood(s)}}})})),1):t._e(),t.isHistory?o("goods-history",{attrs:{goodsHistory:t.goodsHistory},on:{search:t.historySearch}}):t._e()],1),o("div",{staticClass:"search-content"},[t.isContent?o("van-list",{attrs:{loading:t.loading,finished:t.finished,"finished-text":"没有更多了","immediate-check":!1},on:{load:function(s){return t.onLoad()}}},[t.isGoods?t._l(t.goodsList,(function(s){return o("good-card",{key:s.id,attrs:{goodInfo:s,num:t.goodsMap[s.id]}})})):o("van-empty",{attrs:{description:"该类目没有商品"}})],2):t._e()],1)])},e=[],n=o("2909"),a=o("5530"),c=(o("07ac"),o("7db0"),o("99af"),o("d654")),r=function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"goods-history"},[o("div",{staticClass:"header"},[t._v("历史记录：")]),t._l(t.goodsHistory,(function(s){return o("div",{key:s.time,staticClass:"history-item",on:{touchend:function(o){return t.onClick(s.value)}}},[t._v(" "+t._s(s.value)+" ")])}))],2)},u=[],h={props:["goodsHistory"],methods:{onClick:function(t){this.$emit("search",t)}}},l=h,d=(o("056a"),o("2877")),f=Object(d["a"])(l,r,u,!1,null,"5ec3037c",null),g=f.exports,p={throttle:function(t,s){var o,i,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e?function(){(!o||Date.now()-o>=s)&&(t.apply(null,arguments),o=Date.now())}:function(){if(!i){var o=arguments;i=setTimeout((function(){t.apply(null,o),i=null}),s)}}},debounce:function(t,s){var o;return function(){o&&clearTimeout(o);var i=arguments;o=setTimeout((function(){t.apply(null,i)}),s)}}},y=o("365c"),v=o("2f62"),m={mounted:function(){this.isBlur=!0},components:{GoodCard:c["a"],GoodsHistory:g},data:function(){return{placeholder:"水",searchValue:"",showResult:!1,loading:!1,finished:!1,searchResult:[],isContent:!1,isIcon:!0,isGoods:!0,isHistory:!0,page:1,goodsList:[],goodsHistory:[]}},computed:Object(a["a"])(Object(a["a"])({},Object(v["d"])({goodsMap:function(t){return t.goodsMap}})),{},{badge:function(){var t=Object.values(this.goodsMap).length;return 0===t?null:t}}),created:function(){var t=JSON.parse(localStorage.getItem("goodsHistory"))||[];this.goodsHistory=t},watch:{},methods:{input:p.debounce((function(t){y["a"].getLikeSearch({likeValue:t.searchValue}).then((function(s){t.searchResult=s.result}))}),500),onInput:function(){this.searchValue?(this.searchResult=[],this.showResult=!0,this.isHistory=!1,this.input(this)):(this.isHistory=!0,this.showResult=!1)},onFocus:function(){this.isIcon=!0,this.isContent=!1,this.isHistory=!0},historySearch:function(t){this.searchValue=t,this.onSearch()},onSearch:function(){var t=this;this.isContent=!0,this.showResult=!1,this.isHistory=!1,this.goodsList=[];var s=this.goodsHistory.find((function(s){return s.value===t.searchValue}));s?(s.time=(new Date).getTime(),this.goodsHistory.sort((function(t,s){s.time,t.time}))):(this.goodsHistory.unshift({value:this.searchValue,time:(new Date).getTime()}),this.goodsHistory>10&&this.goodsHistory.pop()),localStorage.setItem("goodsHistory",JSON.stringify(this.goodsHistory)),y["a"].getSearch({type:this.searchValue,page:1,size:6}).then((function(s){s.list.length>0?(t.isGoods=!0,t.goodsList=s.list):t.isGoods=!1,t.isIcon=!1}))},onClickGood:function(t){var s=this;this.searchValue=t,this.isContent=!0,this.showResult=!1,this.isHistory=!1,this.goodsList=[],y["a"].getSearch({type:t,page:1,size:6}).then((function(t){t.list.length>0?(s.isGoods=!0,s.goodsList=t.list):s.isGoods=!1,s.isIcon=!1}))},onLoad:function(){var t=this;this.loading=!0,this.page+=1,y["a"].getSearch({type:this.searchValue,page:this.page,size:6}).then((function(s){t.goodsList.length<s.total?(t.goodsList=[].concat(Object(n["a"])(t.goodsList),Object(n["a"])(s.list)),t.loading=!1):(t.loading=!1,t.finished=!0)}))},goBack:function(){window.history.go(-1)}}},b=m,w=(o("1845"),Object(d["a"])(b,i,e,!1,null,"34d08b6b",null));s["default"]=w.exports},3589:function(t,s,o){},"7db0":function(t,s,o){"use strict";var i=o("23e7"),e=o("b727").find,n=o("44d2"),a="find",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),i({target:"Array",proto:!0,forced:c},{find:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),n(a)},"9b4d":function(t,s,o){}}]);
//# sourceMappingURL=chunk-66f44ffe.31e1b083.js.map